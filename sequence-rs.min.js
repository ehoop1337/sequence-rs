class SequenceRS{constructor(t){this.context=null,this.arrayFrames=[],this.animation=!1,this.currentFrame=0,this.requestId=0,this.fpsInterval=null,this.startTime=null,this.now=null,this.then=null,this.elapsed=null,this.loadedFrames=0,this.canvas=t.canvas,this.width=t.width,this.height=t.height,this.countFrames=t.frames.count,this.pathFrames=t.frames.path,this.nameFrames=t.frames.name,this.padFrames=t.frames.pad,this.formatFrames=t.frames.format,this.widthFrames=t.frames.width||t.width,this.heightFrames=t.frames.height||t.height,this.webp=t.frames.webp||!1,this.sx=t.frames.sx||0,this.sy=t.frames.sy||0,this.x=t.frames.x||0,this.y=t.frames.y||0,this.loop=t.loop||!1,this.fps=t.fps||0,this.startFrame=t.startFrame||0,this.renderFirstFrame=t.preview||!1,this.startAfterLoading=t.startAfterLoading||!1,this.events=t.on||{},this.preventDefault=t.preventDefault||!1,this.addListener(),this.checkRequiredSettings()&&(this.preventDefault||this.init())}checkRequiredSettings=()=>this.canvas?this.width?this.height?this.countFrames?this.pathFrames?this.nameFrames?this.padFrames?!!this.formatFrames||this.errorRequired("format"):this.errorRequired("pad"):this.errorRequired("name"):this.errorRequired("path"):this.errorRequired("count"):this.errorRequired("height"):this.errorRequired("width"):this.errorRequired("canvas");addListener=()=>{for(let t in this.events)this.canvas.addEventListener(t,this.events[t].bind(this))};init=()=>{this.context=this.canvas.getContext("2d"),this.setSizesCanvas(this.width,this.height),this.setCurrentFrame(this.startFrame),this.eventInit(),this.preventDefault||this.load()};load=()=>{this.eventLoad();let t=(t,e)=>{this.arrayFrames[t]=e,this.loadedOneFrame(),this.eventLoading(),this.checkLoaded()&&(this.eventLoaded(),!this.preventDefault&&this.startAfterLoading&&this.start()),this.renderFirstFrame&&t==this.currentFrame&&(this.context.clearRect(0,0,this.width,this.height),this.context.drawImage(this.arrayFrames[this.currentFrame],0,0))},e=()=>{for(let e=0;e<this.countFrames;e++){const s=new Image;s.src=this.getPathFrame(e),s.onload=()=>t(e,s),s.onerror=()=>{const s=new Image;s.src=this.getPathFrame(e),s.onload=()=>t(e,s)}}};this.webp?this.isWebpSupported().then((t=>{e()})):e()};start=t=>!0!==this.animation&&(this.eventStart(),this.animation=!0,this.setCurrentFrame(t||this.startFrame),this.fps>0&&(this.fpsInterval=1e3/this.fps,this.then=Date.now(),this.startTime=this.then),this.looping(),!0);pause=()=>!1!==this.animation&&(this.eventPause(),this.animation=!1,!0);play=()=>!0!==this.animation&&(this.eventPlay(),this.animation=!0,this.looping(),!0);stop=t=>!1!==this.animation&&(this.eventStop(),window.cancelAnimationFrame(this.requestId),this.animation=!1,this.requestId=0,this.setCurrentFrame(t||this.startFrame),!0);restart=t=>(this.eventRestart(),this.setCurrentFrame(t||this.startFrame),!0!==this.animation&&(this.animation=!0,this.looping()),!0);render=t=>{!0===this.animation&&(this.context.clearRect(0,0,this.width,this.height),this.context.drawImage(this.arrayFrames[this.currentFrame],this.sx,this.sy,this.widthFrames,this.heightFrames,this.x,this.y,this.width,this.height),t())};looping=()=>{!0===this.animation&&(this.render((()=>{this.requestId=window.requestAnimationFrame(this.looping)})),this.fps>0?(this.now=Date.now(),this.elapsed=this.now-this.then,this.elapsed>this.fpsInterval&&(this.then=this.now-this.elapsed%this.fpsInterval,this.animate())):this.animate())};animate=()=>{this.currentFrame<this.countFrames-1?(this.currentFrame=this.currentFrame+1,this.eventUpdate()):this.loop?(this.currentFrame=0,this.eventUpdate()):this.stop()};setStartFrame=t=>(this.startFrame=t,!0);getStartFrame=()=>this.startFrame;setLoop=t=>(this.loop=t,!0);getLoop=()=>this.loop;setFPS=t=>(this.fps=t,!0);getFPS=()=>this.fps;setSizesCanvas=(t,e)=>(this.width=t,this.height=e,this.canvas.setAttribute("width",t),this.canvas.setAttribute("height",e),!0);getSizesCanvas=()=>[this.width,this.height];setSizesFrames=(t,e)=>(this.widthFrames=t,this.heightFrames=e,!0);getSizesFrames=()=>[this.widthFrames,this.heightFrames];setCurrentFrame=t=>(this.currentFrame=t,!0);getCurrentFrame=()=>this.currentFrame;on=(t,e)=>{this.canvas.addEventListener(t,e.bind(this))};eventInit=()=>{this.canvas.dispatchEvent(new CustomEvent("init",{bubbles:!0,detail:{}}))};eventLoad=()=>{this.canvas.dispatchEvent(new CustomEvent("load",{bubbles:!0,detail:{}}))};eventLoading=()=>{this.canvas.dispatchEvent(new CustomEvent("loading",{bubbles:!0,detail:{}}))};eventLoaded=()=>{this.canvas.dispatchEvent(new CustomEvent("loaded",{bubbles:!0,detail:{}}))};eventStart=()=>{this.canvas.dispatchEvent(new CustomEvent("start",{bubbles:!0,detail:{}}))};eventPause=()=>{this.canvas.dispatchEvent(new CustomEvent("pause",{bubbles:!0,detail:{}}))};eventPlay=()=>{this.canvas.dispatchEvent(new CustomEvent("play",{bubbles:!0,detail:{}}))};eventStop=()=>{this.canvas.dispatchEvent(new CustomEvent("stop",{bubbles:!0,detail:{}}))};eventRestart=()=>{this.canvas.dispatchEvent(new CustomEvent("restart",{bubbles:!0,detail:{}}))};eventUpdate=()=>{this.canvas.dispatchEvent(new CustomEvent("update",{bubbles:!0,detail:{}}))};eventLooped=()=>{this.canvas.dispatchEvent(new CustomEvent("looped",{bubbles:!0,detail:{}}))};errorRequired=t=>(console.error("Required parameter is not specified: ",t),!1);isWebpSupported=()=>new Promise(((t,e)=>{const s=new Image;s.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA",s.onload=s.onerror=function(){t(2===s.height)}})).then((t=>this.webp=t));getPathFrame=t=>`${this.pathFrames+this.nameFrames+t.toString().padStart(this.padFrames,"0")}.${!0===this.webp?"webp":this.formatFrames}`;checkLoaded=()=>100===this.getLoadingPercent();getLoadingPercent=()=>parseInt(this.loadedFrames/(this.countFrames/100));loadedOneFrame=()=>{this.loadedFrames++}}

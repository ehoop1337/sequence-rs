class SequenceRS{#t=0;#s=null;#e=null;#i=null;#a=null;#h=null;#r=null;constructor(t){this.canvas=t.canvas,this.context=this.canvas.getContext("2d"),this.width=t.width||1920,this.height=t.height||950,this.frames=t.frames,this.fps=t.fps||0,this.path=t.path||"/",this.webp=t.webp||!1,this.browserIsWebpSupported=this.#n(),this.format=t.format||"jpg",this.name=t.name||"",this.pad=t.pad||5,this.arrayFrames=new Array,this.loadedFrames=0,this.currentFrame=t.startFrame||0,this.upload=t.upload||!1,this.obsession=t.obsession||!1,this.start=t.start||!1,this.setSizes(),this.upload&&this.load(),this.animation=!1}#n(){return new Promise(((t,s)=>{const e=new Image;e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA",e.onload=e.onerror=function(){t(2===e.height)}}))}#o=t=>this.browserIsWebpSupported&&this.webp?`${this.path+this.name+t.toString().padStart(5,"0")}.webp`:`${this.path+this.name+t.toString().padStart(5,"0")}.${this.format}`;getLoadingPercent=()=>parseInt(this.loadedFrames/(this.frames/100));#m=()=>{this.loadedFrames++};load=()=>{for(let t=0;t<this.frames;t++){const s=new Image;s.src=this.#o(t),s.onload=()=>{this.#m(),this.arrayFrames[t]=s,t==this.currentFrame&&this.#d(t),this.#p()},s.onerror=()=>{const s=new Image;s.src=this.#o(t),s.onload=()=>{this.#m(),this.arrayFrames[t]=s,t==this.currentFrame&&(this.#d(t),this.#p())}}}};#p=()=>{100===this.getLoadingPercent()&&(this.#c(),this.start&&(this.fps>0?this.playFPS():this.play()))};getCurrentFrame=()=>this.currentFrame;setCurrentFrame=t=>{t<this.frames&&t>=0&&(this.currentFrame=t)};setSizes=(t=this.width,s=this.height)=>{this.canvas.setAttribute("width",t),this.canvas.setAttribute("height",s)};setFPS=t=>{this.fps=t};playFPS=()=>{this.animation=!0,this.#e=1e3/this.fps,this.#h=Date.now(),this.#i=this.#h,this.#l()};#l=()=>{!0===this.animation&&(this.play(),this.fps>0?(this.#a=Date.now(),this.#r=this.#a-this.#h,this.#r>this.#e&&(this.#h=this.#a-this.#r%this.#e,this.#u())):this.#u())};#u=()=>{this.currentFrame<this.frames-1?this.currentFrame=this.currentFrame+1:this.obsession?this.currentFrame=0:this.stop()};play=()=>{this.animation=!0,this.#F((()=>{this.#t=window.requestAnimationFrame(this.#l)}))};stop=()=>{if(this.#t>0)return window.cancelAnimationFrame(this.#t),this.animation=!1,void(this.#t=0)};#F=t=>{!0===this.animation&&(this.#w(),this.context.clearRect(0,0,this.width,this.height),this.context.drawImage(this.arrayFrames[this.currentFrame],0,0),t())};#d=(t=null)=>{this.context.clearRect(0,0,this.width,this.height),null!=t?this.context.drawImage(this.arrayFrames[t],0,0):this.context.drawImage(this.arrayFrames[this.currentFrame],0,0)};setObsession=t=>{this.obsession=t};on=(t,s)=>{this.canvas.addEventListener(t,s)};#w=()=>{this.canvas.dispatchEvent(new CustomEvent("update",{bubbles:!0,detail:{canvas:this.canvas,context:this.context,width:this.width,height:this.height,frames:this.frames,arrayFrames:this.arrayFrames,currentFrame:this.currentFrame,animation:this.animation}}))};#c=()=>{this.canvas.dispatchEvent(new CustomEvent("init",{bubbles:!0,detail:{canvas:this.canvas,context:this.context,width:this.width,height:this.height,frames:this.frames,fps:this.fps,path:this.path,webp:this.webp,browserIsWebpSupported:this.browserIsWebpSupported,format:this.format,name:this.name,pad:this.pad,arrayFrames:this.arrayFrames,loadedFrames:this.loadedFrames,currentFrame:this.currentFrame,upload:this.upload,obsession:this.obsession,start:this.start,animation:this.animation}}))}}
